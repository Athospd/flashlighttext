PKG_CPPFLAGS = -Iflashlighttext/include -Iflashlighttext/include/kenlm 
PKG_LIBS = flashlighttext/lib/libflashlight-text.a \
           flashlighttext/lib/libflashlight-text-kenlm.a \
           flashlighttext/lib/libkenlm.a \
           flashlighttext/lib/libkenlm_util.a \
           flashlighttext/lib/libkenlm_filter.a \
           flashlighttext/lib/libkenlm_builder.a 

all: flashlight $(SHLIB)
$(SHLIB): flashlight


flashlight:
	@echo "Building"
	@echo CXX is ${CXX}
	mkdir build || true
	(export CXX=/usr/bin/g++; \
	echo CXX is --- ${CXX}; \
	 cd build; \
    CC="$(CC)" CFLAGS="$(CFLAGS)" \
    CPPFLAGS="$(CPPFLAGS)" LDFLAGS="$(LDFLAGS)" \
    cmake .. \
    -DCMAKE_BUILD_TYPE=Release; \
    cmake --build . --config Release; \
    find ../../.. -depth -path '*CMakeLists.txt' | xargs rm -rf {}; \
    find ../.. -depth -path '*src/build*' | xargs rm -rf {}; \
    find ../.. -depth -path '*src/flashlighttext/include/kenlm/lm*' | xargs rm -rf {}; \
    find ../.. -depth -path '*src/flashlighttext/include/gtest/internal*' | xargs rm -rf {}; )

